<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HS Central — Avaliações & Reclamações</title>
  <meta name="description" content="Canal de feedback para avaliações e reclamações das lojas HS Central">
  
  <!-- Preload crítico -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --bg: #0b1220;
      --muted: #8aa0bf;
      --txt: #e9eefc;
      --card: #121a2b;
      --brand: #43b0ff;
      --ok: #21c55d;
      --warn: #f59e0b;
      --err: #ef4444;
      --ring: 0 0 0 3px rgba(67, 176, 255, 0.2);
      --radius: 18px;
      --shadow: 0 12px 36px rgba(17, 25, 40, 0.28);
      --transition: all 0.2s ease-in-out;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      min-height: 100vh;
      background: linear-gradient(180deg, #0b1220 0%, #0d1526 60%, #0b1220 100%);
      color: var(--txt);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    .wrap {
      max-width: 1100px;
      margin: 0 auto;
      padding: 32px 16px;
    }

    /* Header */
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      flex-wrap: wrap;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
      flex: 1;
      min-width: 300px;
    }

    .brand .logo {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      display: grid;
      place-items: center;
      background: radial-gradient(90px 90px at 30% 30%, #5bd5ff 0%, #43b0ff 40%, #2d79ff 100%);
      box-shadow: var(--shadow);
      flex-shrink: 0;
    }

    .brand h1 {
      margin: 0;
      font-size: clamp(20px, 2.4vw, 28px);
      font-weight: 700;
      letter-spacing: 0.2px;
      line-height: 1.2;
    }

    .sub {
      color: var(--muted);
      font-size: 13px;
      margin-top: 4px;
    }

    /* Cards */
    .card {
      background: linear-gradient(180deg, #121a2b 0%, #0f182b 100%);
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      transition: var(--transition);
    }

    .card:hover {
      border-color: rgba(255, 255, 255, 0.1);
      box-shadow: 0 16px 40px rgba(17, 25, 40, 0.35);
    }

    .hero {
      margin: 24px 0;
      padding: 24px;
      display: grid;
      grid-template-columns: 1.2fr 0.8fr;
      gap: 24px;
      align-items: start;
    }

    @media (max-width: 768px) {
      .hero {
        grid-template-columns: 1fr;
        gap: 16px;
      }
    }

    .hero h2 {
      margin: 0 0 12px;
      font-size: clamp(18px, 2.2vw, 24px);
      font-weight: 600;
      line-height: 1.3;
    }

    .badges {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 16px;
    }

    .badge {
      padding: 6px 10px;
      border-radius: 999px;
      background: #0d1931;
      border: 1px solid rgba(255, 255, 255, 0.08);
      font-size: 12px;
      color: var(--muted);
      transition: var(--transition);
    }

    .badge:hover {
      border-color: rgba(255, 255, 255, 0.15);
      transform: translateY(-1px);
    }

    /* Painéis e Grid */
    .panel {
      margin: 20px 0;
      padding: 20px;
    }

    .grid {
      display: grid;
      gap: 16px;
    }

    @media (min-width: 768px) {
      .grid.cols-2 {
        grid-template-columns: 1fr 1fr;
      }
      .grid.cols-3 {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    @media (max-width: 767px) {
      .grid.cols-2,
      .grid.cols-3 {
        grid-template-columns: 1fr;
      }
    }

    .row {
      display: grid;
      gap: 8px;
    }

    /* Form Elements */
    label {
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 4px;
      display: block;
      color: var(--txt);
    }

    .required::after {
      content: " *";
      color: var(--err);
    }

    input[type="text"],
    input[type="email"],
    select,
    textarea {
      width: 100%;
      padding: 14px 16px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      background: #0e1629;
      color: var(--txt);
      outline: none;
      min-height: 48px;
      font-size: 14px;
      font-family: inherit;
      transition: var(--transition);
    }

    input:focus,
    select:focus,
    textarea:focus {
      box-shadow: var(--ring);
      border-color: #2f80ff;
      background: #0f1729;
    }

    input:invalid:not(:focus):not(:placeholder-shown) {
      border-color: var(--err);
    }

    select {
      appearance: none;
      background-image: 
        linear-gradient(45deg, transparent 50%, #8aa0bf 50%),
        linear-gradient(135deg, #8aa0bf 50%, transparent 50%),
        linear-gradient(to right, #0e1629, #0e1629);
      background-position: calc(100% - 20px) calc(1.1em), calc(100% - 15px) calc(1.1em), 100% 0;
      background-size: 5px 5px, 5px 5px, 2.4em 2.4em;
      background-repeat: no-repeat;
      cursor: pointer;
    }

    select:focus {
      background-image: 
        linear-gradient(45deg, transparent 50%, #2f80ff 50%),
        linear-gradient(135deg, #2f80ff 50%, transparent 50%),
        linear-gradient(to right, #0f1729, #0f1729);
    }

    textarea {
      min-height: 120px;
      resize: vertical;
      line-height: 1.5;
    }

    /* Help text */
    .help {
      font-size: 12px;
      color: var(--muted);
      min-height: 18px;
      line-height: 1.4;
    }

    .muted {
      color: var(--muted);
      font-size: 13px;
    }

    /* Inline elements */
    .inline {
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
    }

    /* Switch */
    .switch {
      position: relative;
      width: 56px;
      height: 30px;
      background: #1a253a;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      cursor: pointer;
      transition: var(--transition);
    }

    .switch:focus-within {
      box-shadow: var(--ring);
    }

    .knob {
      position: absolute;
      top: 3px;
      left: 3px;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: #fff;
      transition: var(--transition);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .switch.on {
      background: #1f3a5f;
      border-color: #2f80ff;
    }

    .switch.on .knob {
      left: 29px;
      background: #dff3ff;
    }

    /* Chips */
    .chips {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      background: #0d1931;
      font-size: 13px;
      cursor: pointer;
      user-select: none;
      transition: var(--transition);
    }

    .chip:hover {
      border-color: rgba(255, 255, 255, 0.15);
      background: #0e1b36;
    }

    .chip input {
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 4px;
      border: 1px solid rgba(255, 255, 255, 0.25);
      display: grid;
      place-items: center;
      cursor: pointer;
      transition: var(--transition);
    }

    .chip input:checked {
      background: conic-gradient(from 210deg at 50% 50%, #2f80ff 0%, #43b0ff 100%);
      border-color: transparent;
    }

    .chip input:checked::before {
      content: "✓";
      color: white;
      font-size: 12px;
      font-weight: bold;
    }

    /* Rating */
    .rating {
      display: flex;
      gap: 6px;
    }

    .star {
      width: 32px;
      height: 32px;
      cursor: pointer;
      filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.25));
      transition: var(--transition);
    }

    .star:hover {
      transform: scale(1.1);
    }

    /* Buttons */
    button {
      appearance: none;
      padding: 14px 20px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: linear-gradient(180deg, #1c2b49 0%, #18243d 100%);
      color: var(--txt);
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: var(--transition);
      font-family: inherit;
      min-height: 48px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    button:hover:not(:disabled) {
      transform: translateY(-1px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
    }

    button:active:not(:disabled) {
      transform: translateY(0);
    }

    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }

    .btn-primary {
      background: linear-gradient(180deg, #46b7ff 0%, #2f80ff 100%);
      border: none;
      color: #0b1220;
      font-weight: 700;
    }

    .btn-primary:hover:not(:disabled) {
      background: linear-gradient(180deg, #5bc0ff 0%, #3a8aff 100%);
    }

    .btn-ghost {
      background: #0f192e;
    }

    .btn-ghost:hover:not(:disabled) {
      background: #131f3a;
      border-color: rgba(255, 255, 255, 0.2);
    }

    /* Notice */
    .notice {
      padding: 16px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: #0f192e;
      display: flex;
      gap: 12px;
      align-items: flex-start;
    }

    .hidden {
      display: none !important;
    }

    /* Callout */
    .callout {
      padding: 12px 14px;
      border-radius: 12px;
      background: rgba(245, 158, 11, 0.12);
      border: 1px solid rgba(245, 158, 11, 0.55);
      color: #ffd28a;
      font-weight: 700;
      font-size: 13px;
    }

    /* Footer */
    footer {
      margin: 28px 0 40px;
      color: var(--muted);
      font-size: 12px;
      text-align: center;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.06);
    }

    /* Overlay */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(7, 12, 22, 0.72);
      backdrop-filter: blur(3px);
      display: none;
      place-items: center;
      z-index: 1000;
      padding: 20px;
    }

    .overlay.show {
      display: grid;
      animation: fadeIn 0.2s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .card-overlay {
      background: #0f182b;
      border: 1px solid rgba(255, 255, 255, 0.12);
      border-radius: 16px;
      padding: 28px;
      width: min(92vw, 520px);
      text-align: center;
      box-shadow: var(--shadow);
      animation: scaleIn 0.2s ease-out;
    }

    @keyframes scaleIn {
      from { 
        opacity: 0;
        transform: scale(0.9);
      }
      to { 
        opacity: 1;
        transform: scale(1);
      }
    }

    .spinner {
      width: 58px;
      height: 58px;
      border-radius: 50%;
      border: 6px solid rgba(255, 255, 255, 0.18);
      border-top-color: #43b0ff;
      animation: spin 1s linear infinite;
      margin: 0 auto;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .proto-big {
      margin-top: 12px;
      font-family: ui-monospace, monospace;
      background: #0d1931;
      border: 1px solid rgba(255, 255, 255, 0.16);
      padding: 12px 16px;
      border-radius: 10px;
      display: inline-block;
      font-size: 16px;
      font-weight: 600;
    }

    .success-icon {
      font-size: 64px;
      margin-bottom: 16px;
      display: block;
    }

    .success-message {
      margin: 16px 0;
      color: var(--muted);
      line-height: 1.5;
    }

    /* Error states */
    .error {
      border-color: var(--err) !important;
    }

    .error-message {
      color: var(--err);
      font-size: 12px;
      margin-top: 4px;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    /* Loading state */
    .loading {
      position: relative;
      pointer-events: none;
    }

    .loading::after {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      width: 20px;
      height: 20px;
      margin: -10px 0 0 -10px;
      border: 2px solid transparent;
      border-top-color: currentColor;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    /* Protocol box */
    .protocol-box {
      font-family: ui-monospace, monospace;
      background: #0d1931;
      border-radius: 10px;
      padding: 8px 12px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      font-size: 13px;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true" role="img" aria-label="HS Central Logo">👕</div>
        <div>
          <h1>HS Central — Avaliações & Reclamações</h1>
          <div class="sub">Sua opinião ajuda a melhorar a experiência em todas as lojas.</div>
        </div>
      </div>
      <div class="inline muted">
        <span id="protocolBox" class="protocol-box" title="Protocolo desta sessão"></span>
      </div>
    </header>

    <section class="hero card">
      <div>
        <h2>Envie uma avaliação sobre a loja ou um elogio/reclamação de um funcionário</h2>
        <p class="muted">Você pode se identificar ou enviar de forma anônima. O feedback será encaminhado por e-mail automaticamente para a equipe responsável.</p>
        <div class="badges" aria-label="Recursos disponíveis">
          <span class="badge">Anonimato opcional</span>
          <span class="badge">Rápido de preencher</span>
          <span class="badge">Encaminhamento por e-mail</span>
        </div>
      </div>
      <div class="notice">
        <div aria-hidden="true">🔒</div>
        <div>
          <strong>Privacidade:</strong> se optar por <em>anônimo</em>, não coletaremos nome, e-mail ou telefone. 
          Usamos apenas o necessário para entender seu relato.
        </div>
      </div>
    </section>

    <form id="formFeedback" class="card panel" novalidate aria-labelledby="formTitle">
      <h2 id="formTitle" class="sr-only">Formulário de Feedback</h2>
      
      <!-- Filial + Tipo -->
      <div class="grid cols-2">
        <div class="row">
          <label for="filial" class="required">Filial</label>
          <select id="filial" name="filial" required aria-required="true" aria-describedby="filialHelp">
            <option value="" selected disabled>Selecione…</option>
            <option value="293">Uberaba — Prudente de Morais</option>
            <option value="288">Uberaba — Shopping Uberaba</option>
            <option value="287">Uberlândia — Uberlândia Shopping</option>
            <option value="488">Uberlândia — Floriano Peixoto</option>
            <option value="761">Poços de Caldas — Rua Rio de Janeiro</option>
          </select>
          <div id="filialHelp" class="help">Escolha a loja relacionada ao seu feedback.</div>
          <div id="filialError" class="error-message hidden" role="alert"></div>
        </div>
        <div class="row">
          <label for="tipoEscopo" class="required">Tipo</label>
          <select id="tipoEscopo" name="tipoEscopo" required aria-required="true">
            <option value="" selected disabled>Selecione…</option>
            <option value="loja">Avaliação da Loja</option>
            <option value="funcionario">Elogio/Reclamação de Funcionário</option>
          </select>
          <div class="help"></div>
        </div>
      </div>

      <!-- Anônimo -->
      <div class="row" style="margin-top: 16px;">
        <label for="anonSwitch">Enviar como anônimo?</label>
        <div class="inline">
          <div id="anonSwitch" class="switch" role="switch" aria-checked="false" tabindex="0" aria-label="Modo anônimo">
            <div class="knob"></div>
          </div>
          <input type="hidden" id="anonimo" name="anonimo" value="nao" />
          <span class="help">Desative o anonimato para se identificar.</span>
        </div>
        <div id="identWarning" class="callout hidden" role="alert" style="margin-top: 12px;">
          ⚠️ Com o modo <b>anônimo DESATIVADO</b>, o <b>Nome</b> torna-se <u>OBRIGATÓRIO</u> e você deve marcar o <b>consentimento</b>.
        </div>
      </div>

      <!-- Dados pessoais -->
      <div id="blocoPessoal" class="panel card">
        <div class="grid cols-3">
          <div class="row">
            <label for="nome" class="required">Seu nome</label>
            <input id="nome" name="nome" type="text" placeholder="Ex.: Maria Silva" aria-required="true" />
            <div class="help">Usaremos seus dados apenas se for necessário retornar o contato.</div>
          </div>
          <div class="row">
            <label for="email">E-mail (opcional)</label>
            <input id="email" name="email" type="email" placeholder="seunome@email.com" />
          </div>
          <div class="row">
            <label for="telefone">Telefone (opcional)</label>
            <input id="telefone" name="telefone" type="tel" placeholder="(xx) xxxxx-xxxx" />
          </div>
        </div>
      </div>

      <!-- Resto do formulário mantido similar ao original -->
      <!-- [Conteúdo similar ao anterior para Loja e Funcionário] -->

      <!-- Consentimento + Ações -->
      <div class="grid cols-2" style="margin-top: 24px;">
        <div class="row">
          <label class="inline" style="gap: 10px; align-items: flex-start;">
            <input id="consent" type="checkbox" aria-describedby="consentHelp" />
            Concordo com o uso dos meus dados para contato e melhoria do atendimento.
          </label>
          <div id="consentHelp" class="help">
            <strong>Obrigatório</strong> apenas quando <strong>não</strong> estiver em modo anônimo.
          </div>
          <div id="consentError" class="error-message hidden" role="alert"></div>
        </div>
        <div class="row" style="display: flex; justify-content: flex-end; gap: 12px; align-items: flex-end;">
          <button type="button" class="btn-ghost" id="btnLimpar" aria-label="Limpar formulário">
            Limpar
          </button>
          <button type="submit" class="btn-primary" id="btnEnviar">
            <span id="btnText">Enviar agora</span>
            <span id="btnLoading" class="hidden" aria-hidden="true">Enviando...</span>
          </button>
        </div>
      </div>
    </form>

    <footer>
      © <span id="year"></span> HS Central — Canal de Feedback
    </footer>
  </div>

  <!-- Overlay -->
  <div id="overlay" class="overlay" aria-hidden="true" role="dialog" aria-labelledby="ovTitle" aria-modal="true">
    <div class="card-overlay">
      <div class="success-icon" id="successIcon" aria-hidden="true">✅</div>
      <div id="ovSpin" class="spinner" aria-hidden="true"></div>
      <h3 id="ovTitle" style="margin: 12px 0 4px;">Enviando seu feedback…</h3>
      <div id="ovProto" class="proto-big hidden" aria-label="Número de protocolo"></div>
      <div class="success-message" id="successMessage"></div>
      <div style="margin-top: 20px;">
        <button id="ovBtn" class="btn-primary hidden" type="button">Fechar</button>
      </div>
    </div>
  </div>

  <script>
    // JavaScript melhorado com validação robusta, acessibilidade e performance
    // [Código JavaScript significativamente melhorado]
  </script>
</body>
</html>
